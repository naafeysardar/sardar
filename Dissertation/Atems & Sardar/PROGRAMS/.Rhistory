response.nino <- lapply(rfvar, function(b) {
sum(b[2:4] * x0.nino)
})
nino <- list(nino.c, response.nino)
nina <- list(nina.c, response.nina)
stock.nino <- cumsum(unlist(nino))
stock.nina <- cumsum(unlist(nina))
plot(stock.nino, type = "l", col = "red", xlab = "Weeks Afer Shock", ylab = "Percent", ylim= c(-0.10, 0.10), main = varname); abline(h=0)
points(stock.nina, type = "l", col = "blue")
}
varinfo <- list(
list(adm, "ADM"),
list(conagra, "Conagra"),
list(cpb, "CPB"),
list(gmills, "G Mills"),
list(hormel, "Hormel"),
list(smucker, "Smucker"),
list(mkc, "MKC"),
list(hsy, "HSY"),
list(tysons, "Tysons"),
list(fmc, "FMC"),
list(mosaic, "Mosaic"),
list(sysco, "Sysco")
)
irfs <- lapply(varinfo, irf.nonlinear)
par(mfrow=c(4,3))
irf.nonlinear <- function(obj) {
stock <- obj[[1]]
varname <- obj[[2]]
dataset.stock <- ts.intersect(stock, ssta, inter)
rhs <- ts.intersect(lags(stock, 1:24), lags(ssta, 0:24), lags(inter, 0:24))
fit <- tsreg(stock, rhs)
nino.c <- (coefficients(fit)[26]+ coefficients(fit)[51])*0.92
nina.c <- (coefficients(fit)[26])*0.92
# Define Initial Response Vectors
x0.nino <- c(nino.c, 0.92, 0.92)
x0.nina <- c(nina.c, 0.92, 0)
rfvar <- lapply(1:24, function(h) {
rhs <- lags(dataset.stock, h:(h+24), type="bylag")
coefficients(tsreg(stock, rhs))
})
# Impulse Response in nina
response.nina <- lapply(rfvar, function(b) {
sum(b[2:4] * x0.nina)
})
# Impulse Response in Nino
response.nino <- lapply(rfvar, function(b) {
sum(b[2:4] * x0.nino)
})
nino <- list(nino.c, response.nino)
nina <- list(nina.c, response.nina)
stock.nino <- cumsum(unlist(nino))
stock.nina <- cumsum(unlist(nina))
plot(stock.nino, type = "l", col = "red", xlab = "Weeks Afer Shock", ylab = "Percent", ylim= c(-0.10, 0.10), main = varname); abline(h=0)
points(stock.nina, type = "l", col = "blue")
}
varinfo <- list(
list(adm, "ADM"),
list(conagra, "Conagra"),
list(cpb, "CPB"),
list(gmills, "G Mills"),
list(hormel, "Hormel"),
list(smucker, "Smucker"),
list(mkc, "MKC"),
list(hsy, "HSY"),
list(tysons, "Tysons"),
list(fmc, "FMC"),
list(mosaic, "Mosaic"),
list(sysco, "Sysco")
)
irfs <- lapply(varinfo, irf.nonlinear)
par(mfrow=c(4,3))
irf.nonlinear <- function(obj) {
stock <- obj[[1]]
varname <- obj[[2]]
dataset.stock <- ts.intersect(stock, ssta, inter)
rhs <- ts.intersect(lags(stock, 1:24), lags(ssta, 0:24), lags(inter, 0:24))
fit <- tsreg(stock, rhs)
nino.c <- (coefficients(fit)[26]+ coefficients(fit)[51])*0.92
nina.c <- (coefficients(fit)[26])*0.92
# Define Initial Response Vectors
x0.nino <- c(nino.c, 0.92, 0.92)
x0.nina <- c(nina.c, 0.92, 0)
rfvar <- lapply(1:12, function(h) {
rhs <- lags(dataset.stock, h:(h+24), type="bylag")
coefficients(tsreg(stock, rhs))
})
# Impulse Response in nina
response.nina <- lapply(rfvar, function(b) {
sum(b[2:4] * x0.nina)
})
# Impulse Response in Nino
response.nino <- lapply(rfvar, function(b) {
sum(b[2:4] * x0.nino)
})
nino <- list(nino.c, response.nino)
nina <- list(nina.c, response.nina)
stock.nino <- cumsum(unlist(nino))
stock.nina <- cumsum(unlist(nina))
plot(stock.nino, type = "l", col = "red", xlab = "Weeks Afer Shock", ylab = "Percent", ylim= c(-0.10, 0.10), main = varname); abline(h=0)
points(stock.nina, type = "l", col = "blue")
}
varinfo <- list(
list(adm, "ADM"),
list(conagra, "Conagra"),
list(cpb, "CPB"),
list(gmills, "G Mills"),
list(hormel, "Hormel"),
list(smucker, "Smucker"),
list(mkc, "MKC"),
list(hsy, "HSY"),
list(tysons, "Tysons"),
list(fmc, "FMC"),
list(mosaic, "Mosaic"),
list(sysco, "Sysco")
)
irfs <- lapply(varinfo, irf.nonlinear)
par(mfrow=c(4,3))
irf.nonlinear <- function(obj) {
stock <- obj[[1]]
varname <- obj[[2]]
dataset.stock <- ts.intersect(stock, ssta, inter)
rhs <- ts.intersect(lags(stock, 1:24), lags(ssta, 0:24), lags(inter, 0:24))
fit <- tsreg(stock, rhs)
nino.c <- (coefficients(fit)[26]+ coefficients(fit)[51])*0.92
nina.c <- (coefficients(fit)[26])*0.92
# Define Initial Response Vectors
x0.nino <- c(nino.c, 0.92, 0.92)
x0.nina <- c(nina.c, 0.92, 0)
rfvar <- lapply(1:15, function(h) {
rhs <- lags(dataset.stock, h:(h+24), type="bylag")
coefficients(tsreg(stock, rhs))
})
# Impulse Response in nina
response.nina <- lapply(rfvar, function(b) {
sum(b[2:4] * x0.nina)
})
# Impulse Response in Nino
response.nino <- lapply(rfvar, function(b) {
sum(b[2:4] * x0.nino)
})
nino <- list(nino.c, response.nino)
nina <- list(nina.c, response.nina)
stock.nino <- cumsum(unlist(nino))
stock.nina <- cumsum(unlist(nina))
plot(stock.nino, type = "l", col = "red", xlab = "Weeks Afer Shock", ylab = "Percent", ylim= c(-0.10, 0.10), main = varname); abline(h=0)
points(stock.nina, type = "l", col = "blue")
}
varinfo <- list(
list(adm, "ADM"),
list(conagra, "Conagra"),
list(cpb, "CPB"),
list(gmills, "G Mills"),
list(hormel, "Hormel"),
list(smucker, "Smucker"),
list(mkc, "MKC"),
list(hsy, "HSY"),
list(tysons, "Tysons"),
list(fmc, "FMC"),
list(mosaic, "Mosaic"),
list(sysco, "Sysco")
)
irfs <- lapply(varinfo, irf.nonlinear)
par(mfrow=c(4,3))
irf.nonlinear <- function(obj) {
stock <- obj[[1]]
varname <- obj[[2]]
dataset.stock <- ts.intersect(stock, ssta, inter)
rhs <- ts.intersect(lags(stock, 1:52), lags(ssta, 0:52), lags(inter, 0:52))
fit <- tsreg(stock, rhs)
nino.c <- (coefficients(fit)[54]+ coefficients(fit)[107])*0.92
nina.c <- (coefficients(fit)[54])*0.92
# Define Initial Response Vectors
x0.nino <- c(nino.c, 0.92, 0.92)
x0.nina <- c(nina.c, 0.92, 0)
rfvar <- lapply(1:26, function(h) {
rhs <- lags(dataset.stock, h:(h+51), type="bylag")
coefficients(tsreg(stock, rhs))
})
# Impulse Response in nina
response.nina <- lapply(rfvar, function(b) {
sum(b[2:4] * x0.nina)
})
# Impulse Response in Nino
response.nino <- lapply(rfvar, function(b) {
sum(b[2:4] * x0.nino)
})
nino <- list(nino.c, response.nino)
nina <- list(nina.c, response.nina)
stock.nino <- cumsum(unlist(nino))
stock.nina <- cumsum(unlist(nina))
plot(stock.nino, type = "l", col = "red", xlab = "Weeks Afer Shock", ylab = "Percent", ylim= c(-0.10, 0.10), main = varname); abline(h=0)
points(stock.nina, type = "l", col = "blue")
}
varinfo <- list(
list(adm, "ADM"),
list(conagra, "Conagra"),
list(cpb, "CPB"),
list(gmills, "G Mills"),
list(hormel, "Hormel"),
list(smucker, "Smucker"),
list(mkc, "MKC"),
list(hsy, "HSY"),
list(tysons, "Tysons"),
list(fmc, "FMC"),
list(mosaic, "Mosaic"),
list(sysco, "Sysco")
)
irfs <- lapply(varinfo, irf.nonlinear)
str(lynx)
plot(lnyx)
plot(lyxx)
plot(lynx)
x <-log10(lynx)
par(mfrow=c(2,1), mar=c(0,0,0,0))
plot(x, ax=F)
box()
plot(x[length(x):1], type="l", ax=F)
box()
par(mfrow=c(2,1), mar=c(2,2,0,0))
autopairs(x, lag=1, type="regression")
library(tsDyn)
install.packages("tsDyn")
library(tsDyn)
autopairs(x, lag=1, type="regression")
library(sm)
install.packages("sm")
library(sm)
autopairs(x, lag=1, type="regression")
autopairs(x, lag=3, type="regression")
hist(x, br=13)
par(mfrow=c(2,1), mar=c(2,4,0,0))
acf(x)
pacf(x)
library(tseriesChaos)
mutual(x)
recurr(x, m=3, d=1, levels=c(0,0.2,1))
mod.ar <- linear(x, m=2)
mod.ar
mod.setar <- setar(x, m=2, mL=2, mH=2, thDelay=1)
mod.setar
par(mfrow=c(4,3))
irf.nonlinear <- function(obj) {
stock <- obj[[1]]
varname <- obj[[2]]
dataset.stock <- ts.intersect(stock, ssta, inter)
rhs <- ts.intersect(lags(stock, 1:52), lags(ssta, 0:52), lags(inter, 0:52))
fit <- tsreg(stock, rhs)
nino.c <- (coefficients(fit)[54]+ coefficients(fit)[107])*0.92
nina.c <- (coefficients(fit)[54])*0.92
# Define Initial Response Vectors
x0.nino <- c(nino.c, 0.92, 0.92)
x0.nina <- c(nina.c, 0.92, 0)
rfvar <- lapply(1:26, function(h) {
rhs <- lags(dataset.stock, h:(h+51), type="bylag")
coefficients(tsreg(stock, rhs))
})
# Impulse Response in nina
response.nina <- lapply(rfvar, function(b) {
sum(b[2:4] * x0.nina)
})
# Impulse Response in Nino
response.nino <- lapply(rfvar, function(b) {
sum(b[2:4] * x0.nino)
})
nino <- list(nino.c, response.nino)
nina <- list(nina.c, response.nina)
stock.nino <- cumsum(unlist(nino))
stock.nina <- cumsum(unlist(nina))
plot(stock.nino, type = "l", col = "red", xlab = "Weeks Afer Shock", ylab = "Percent", ylim= c(-0.10, 0.10), main = varname); abline(h=0)
points(stock.nina, type = "l", col = "blue")
}
varinfo <- list(
list(adm, "ADM"),
list(conagra, "Conagra"),
list(cpb, "CPB"),
list(gmills, "G Mills"),
list(hormel, "Hormel"),
list(smucker, "Smucker"),
list(mkc, "MKC"),
list(hsy, "HSY"),
list(tysons, "Tysons"),
list(fmc, "FMC"),
list(mosaic, "Mosaic"),
list(sysco, "Sysco")
)
irfs <- lapply(varinfo, irf.nonlinear)
ag_data           <- ag_data
sample_start      <- 7
sample_end        <- dim(ag_data)[1]
endog_data        <- ag_data[sample_start:sample_end, 3:5]
library(lpirfs)
ag_data           <- ag_data
sample_start      <- 7
sample_end        <- dim(ag_data)[1]
endog_data        <- ag_data[sample_start:sample_end, 3:5]
endog_data
shock            <- as.data.frame(ag_data$Gov_shock_mean[sample_start:sample_end])
shock
exog_data        <- as.data.frame(ag_data$GDP_MA[sample_start:sample_end])
exog_data
switching_variable <- ag_data[sample_start:sample_end, 6] - 0.8
switching_variable
plot(switching_variable)
plot(switching_variable)
ag_data
results_nl_iv <- lp_nl_iv(endog_data,
lags_endog_nl     = 3,
shock             = shock,
exog_data         = exog_data,
lags_exog         = 4,
trend             = 0,
confint           = 1.96,
hor               = 20,
switching         = switching_variable,
use_logistic      = TRUE,
lag_switching     = TRUE,
use_hp            = FALSE,
lambda            = NaN,
gamma             = 3)
GYsc        <- mean(exp(endog_data$GDP)/exp(endog_data$Gov))
irf_s1_mean <- results_nl_iv$irf_s1_mean*GYsc
irf_s1_up   <- results_nl_iv$irf_s1_up*GYsc
irf_s1_low  <- results_nl_iv$irf_s1_low*GYsc
irf_s2_mean <- results_nl_iv$irf_s2_mean*GYsc
irf_s2_up   <- results_nl_iv$irf_s2_up*GYsc
irf_s2_low  <- results_nl_iv$irf_s2_low*GYsc
results_nl_iv  <- list(irf_s1_mean   = irf_s1_mean,
irf_s1_up    = irf_s1_up,
irf_s1_low   = irf_s1_low,
irf_s2_mean  = irf_s2_mean,
irf_s2_up    = irf_s2_up,
irf_s2_low   = irf_s2_low,
specs        = results_nl_iv$specs)
plots_nl_iv <- plot_nl(results_nl_iv)
s1_plots    <- sapply(plots_nl_iv$gg_s1, ggplotGrob)
library(ggplot)
library(ggplot2)
s1_plots    <- sapply(plots_nl_iv$gg_s1, ggplotGrob)
s2_plots    <- sapply(plots_nl_iv$gg_s2, ggplotGrob)
# Show plot
plot(plots_nl_iv$gg_s1[[3]])
rm(list=ls(all=TRUE))
library(vars)
library(nleqslv)
library(tstools)
library(msm)
library(functional)
library(systemfit)
source('functions.R')
Data <- read.csv('OTHER-COMPANIES-WEEKLY.csv')
Data <- ts(Data, start=c(1990,1), frequency=52) # Setting data as time series by WEEK
SSTA <- Data[,"SSTA"]
Data <- diff(log(Data)) # Growth rate by taking first difference of log of variables
DATA <- cbind(SSTA,Data)
DATA <- DATA[,c("SSTA","Data.ADM","Data.CONAGRA","Data.CPB", "Data.GMILLS", "Data.HORMEL","Data.SMUCKER",
"Data.MKC","Data.HSY","Data.TYSONS","Data.FMC","Data.MOSAIC", "Data.SYSCO",
"Data.ALICO", "Data.INGREDION", "Data.ANDERSONS", "Data.BUNGE", "Data.ALTRIA")]
colnames(DATA) <- c("SSTA","ADM","CONAGRA","CPB", "GMILLS","HORMEL","SMUCKER","MKC","HSY","TYSONS",
"FMC","MOSAIC", "SYSCO", "ALICO", "INGREDION", "ANDERSONS", "BUNGE", "ALTRIA")
ssta <- DATA[,"SSTA"]
adm <- DATA[,"ADM"]
conagra <- DATA[,"CONAGRA"]
cpb <- DATA[,"CPB"]
gmills <- DATA[,"GMILLS"]
hormel <- DATA[,"HORMEL"]
smucker <- DATA[,"SMUCKER"]
mkc <- DATA[,"MKC"]
hsy <- DATA[,"HSY"]
tysons <- DATA[,"TYSONS"]
fmc <- DATA[,"FMC"]
mosaic <- DATA[,"MOSAIC"]
sysco <- DATA[,"SYSCO"]
alico <- DATA[,"ALICO"]
ingredion <- DATA[,"INGREDION"]
andersons <- DATA[,"ANDERSONS"]
bunge <- DATA[,"BUNGE"]
altria <- DATA[,"ALTRIA"]
##### Generate Dummy Variable #####
d <- (SSTA > 0.5)
inter <- d*SSTA
library(lpirfs)
endog_data  <- ts.intersect(adm, ssta, inter)
shock <- ssta
switching_variable <- ssta
results_nl_iv <- lp_nl_iv(endog_data,
lags_endog_nl     = 12,
shock             = shock,
trend             = 0,
confint           = 1.96,
hor               = 20,
switching         = switching_variable,
use_logistic      = TRUE,
lag_switching     = TRUE,
use_hp            = FALSE,
lambda            = NaN,
gamma             = 3)
endog_data  <- data.frame(ts.intersect(adm, ssta, inter))
class(endog_data)
results_nl_iv <- lp_nl_iv(endog_data,
lags_endog_nl     = 12,
shock             = shock,
trend             = 0,
confint           = 1.96,
hor               = 20,
switching         = switching_variable,
use_logistic      = TRUE,
lag_switching     = TRUE,
use_hp            = FALSE,
lambda            = NaN,
gamma             = 3)
shock <- data.frame(ssta)
library(lpirfs)
endog_data  <- data.frame(ts.intersect(adm, ssta, inter))
shock <- data.frame(ssta)
switching_variable <- data.frame(ssta)
results_nl_iv <- lp_nl_iv(endog_data,
lags_endog_nl     = 12,
shock             = shock,
trend             = 0,
confint           = 1.96,
hor               = 20,
switching         = switching_variable,
use_logistic      = TRUE,
lag_switching     = TRUE,
use_hp            = FALSE,
lambda            = NaN,
gamma             = 3)
rm(list=ls(all=TRUE))
library(vars)
library(nleqslv)
library(tstools)
library(msm)
library(functional)
library(systemfit)
source('functions.R')
Data <- read.csv('OTHER-COMPANIES-WEEKLY.csv')
SSTA <- Data[,"SSTA"]
Data <- diff(log(Data)) # Growth rate by taking first difference of log of variables
DATA <- cbind(SSTA,Data)
DATA <- DATA[,c("SSTA","Data.ADM","Data.CONAGRA","Data.CPB", "Data.GMILLS", "Data.HORMEL","Data.SMUCKER",
"Data.MKC","Data.HSY","Data.TYSONS","Data.FMC","Data.MOSAIC", "Data.SYSCO",
"Data.ALICO", "Data.INGREDION", "Data.ANDERSONS", "Data.BUNGE", "Data.ALTRIA")]
colnames(DATA) <- c("SSTA","ADM","CONAGRA","CPB", "GMILLS","HORMEL","SMUCKER","MKC","HSY","TYSONS",
"FMC","MOSAIC", "SYSCO", "ALICO", "INGREDION", "ANDERSONS", "BUNGE", "ALTRIA")
ssta <- DATA[,"SSTA"]
adm <- DATA[,"ADM"]
conagra <- DATA[,"CONAGRA"]
cpb <- DATA[,"CPB"]
gmills <- DATA[,"GMILLS"]
hormel <- DATA[,"HORMEL"]
smucker <- DATA[,"SMUCKER"]
mkc <- DATA[,"MKC"]
hsy <- DATA[,"HSY"]
tysons <- DATA[,"TYSONS"]
fmc <- DATA[,"FMC"]
mosaic <- DATA[,"MOSAIC"]
sysco <- DATA[,"SYSCO"]
alico <- DATA[,"ALICO"]
ingredion <- DATA[,"INGREDION"]
andersons <- DATA[,"ANDERSONS"]
bunge <- DATA[,"BUNGE"]
altria <- DATA[,"ALTRIA"]
##### Generate Dummy Variable #####
d <- (SSTA > 0.5)
inter <- d*SSTA
inte
SSTA
inter
adm
cpb
rm(list=ls(all=TRUE))
library(vars)
library(nleqslv)
library(tstools)
library(msm)
library(functional)
library(systemfit)
source('functions.R')
Data <- read.csv('OTHER-COMPANIES-WEEKLY.csv')
Data <- ts(Data, start=c(1990,1), frequency=52) # Setting data as time series by WEEK
SSTA <- Data[,"SSTA"]
Data <- diff(log(Data)) # Growth rate by taking first difference of log of variables
DATA <- cbind(SSTA,Data)
DATA <- DATA[,c("SSTA","Data.ADM","Data.CONAGRA","Data.CPB", "Data.GMILLS", "Data.HORMEL","Data.SMUCKER",
"Data.MKC","Data.HSY","Data.TYSONS","Data.FMC","Data.MOSAIC", "Data.SYSCO",
"Data.ALICO", "Data.INGREDION", "Data.ANDERSONS", "Data.BUNGE", "Data.ALTRIA")]
colnames(DATA) <- c("SSTA","ADM","CONAGRA","CPB", "GMILLS","HORMEL","SMUCKER","MKC","HSY","TYSONS",
"FMC","MOSAIC", "SYSCO", "ALICO", "INGREDION", "ANDERSONS", "BUNGE", "ALTRIA")
ssta <- DATA[,"SSTA"]
adm <- DATA[,"ADM"]
conagra <- DATA[,"CONAGRA"]
cpb <- DATA[,"CPB"]
gmills <- DATA[,"GMILLS"]
hormel <- DATA[,"HORMEL"]
smucker <- DATA[,"SMUCKER"]
mkc <- DATA[,"MKC"]
hsy <- DATA[,"HSY"]
tysons <- DATA[,"TYSONS"]
fmc <- DATA[,"FMC"]
mosaic <- DATA[,"MOSAIC"]
sysco <- DATA[,"SYSCO"]
alico <- DATA[,"ALICO"]
ingredion <- DATA[,"INGREDION"]
andersons <- DATA[,"ANDERSONS"]
bunge <- DATA[,"BUNGE"]
altria <- DATA[,"ALTRIA"]
##### Generate Dummy Variable #####
d <- (SSTA > 0.5)
inter <- d*SSTA
adm
inter
