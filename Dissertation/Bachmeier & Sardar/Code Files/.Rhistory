fitsur <- systemfit(system, data = x)
v <- matrix(vcov(fitsur), nrow = 88, ncol = 88)
rfvar <- lapply(1:5, function(h) {
rhs <- lags(dataset.housing, h:(h+1), type="bylag")
tsreg(housing, rhs)
})
cov.mats <- lapply(rfvar, function(z) {
NeweyWest(z)
})
replaceDiag <- function(a, mats, start=1) {
if (length(mats) == 0) {
return(a)
} else {
a[start:(start+nrow(mats[[1]])-1), start:(start+nrow(mats[[1]])-1)] <-
mats[[1]]
Recall(a, mats[-1], start+nrow(mats[[1]]))
}
}
x.newey <- replaceDiag(v, cov.mats)
# Standard Errors
# 1-Step #
theta <- coefficients(fitsur)[4:6]
v1 <- as.matrix(x.newey[c(4, 5, 6), c(4, 5, 6)])
std.err.1 <- deltamethod(~(-0.15*x1-1.03*x2+7.70*x3), theta, v1)
# 2-Step #
theta <- coefficients(fitsur)[c(4, 5, 6, 15, 16, 17)]
v2 <- as.matrix(x.newey[c(4, 5, 6, 15, 16, 17), c(4, 5, 6, 15, 16, 17)])
std.err.2 <- deltamethod(~(-0.15*x1-1.03*x2+7.70*x3-0.35*x4+2.34*x5+11.10*x6), theta, v2)
# 3-Step #
theta <- coefficients(fitsur)[c(4, 5, 6, 15, 16, 17, 26, 27, 28)]
v3 <- as.matrix(x.newey[c(4, 5, 6, 15, 16, 17, 26, 27, 28), c(4, 5, 6, 15, 16, 17, 26, 27, 28)])
std.err.3 <- deltamethod(~(-0.15*x1-1.03*x2+7.70*x3-0.35*x4+2.34*x5+11.10*x6-0.65*x7+7.87*x8+15.30*x9), theta, v3)
# 4-Step #
theta <- coefficients(fitsur)[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39)]
v4 <- as.matrix(x.newey[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39), c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39)])
std.err.4 <- deltamethod(~(-0.15*x1-1.03*x2+7.70*x3-0.35*x4+2.34*x5+11.10*x6-0.65*x7+7.87*x8+15.30*x9-0.96*x10+13.11*x11+20.51*x12), theta, v4)
# 5-Step #
theta <- coefficients(fitsur)[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50)]
v5 <- as.matrix(x.newey[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50), c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50)])
std.err.5 <- deltamethod(~(-0.15*x1-1.03*x2+7.70*x3-0.35*x4+2.34*x5+11.10*x6-0.65*x7+7.87*x8+15.30*x9-0.96*x10+13.11*x11+20.51*x12
-1.32*x13+18.96*x14+26.63*x15), theta, v5)
# 6-Step #
theta <- coefficients(fitsur)[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61)]
v6 <- as.matrix(x.newey[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61),
c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61)])
std.err.6 <- deltamethod(~(-0.15*x1-1.03*x2+7.70*x3-0.35*x4+2.34*x5+11.10*x6-0.65*x7+7.87*x8+15.30*x9-0.96*x10+13.11*x11+20.51*x12
-1.32*x13+18.96*x14+26.63*x15-0.69*x16+8.46*x17+15.99*x18), theta, v6)
# 7-Step #
theta <- coefficients(fitsur)[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61, 70, 71, 72)]
v7 <- as.matrix(x.newey[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61, 70, 71, 72),
c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61, 70, 71, 72)])
std.err.7 <- deltamethod(~(-0.15*x1-1.03*x2+7.70*x3-0.35*x4+2.34*x5+11.10*x6-0.65*x7+7.87*x8+15.30*x9-0.96*x10+13.11*x11+20.51*x12
-1.32*x13+18.96*x14+26.63*x15-0.69*x16+8.46*x17+15.99*x18-0.76*x19+9.83*x20+17.09*x21), theta, v7)
# 8-Step #
theta <- coefficients(fitsur)[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61, 70, 71, 72, 81, 82, 83)]
v8 <- as.matrix(x.newey[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61, 70, 71, 72, 81, 82, 83),
c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61, 70, 71, 72, 81, 82, 83)])
std.err.8 <- deltamethod(~(-0.15*x1-1.03*x2+7.70*x3-0.35*x4+2.34*x5+11.10*x6-0.65*x7+7.87*x8+15.30*x9-0.96*x10+13.11*x11+20.51*x12
-1.32*x13+18.96*x14+26.63*x15-0.69*x16+8.46*x17+15.99*x18-0.76*x19+9.83*x20+17.09*x21-1.08*x22+15.05*x23+22.59*x24), theta, v8)
s <- unlist(list(std.err.0, std.err.1, std.err.2, std.err.3, std.err.4, std.err.5))
d.housing.upper <- d.housing + 1.96*s
d.housing.lower <- d.housing - 1.96*s
##############################################################################################################################################################
dataset.transport <- ts.intersect(auerbach, gdp, transport, gas, inter)
rhs <- ts.intersect(lags(auerbach, 0:2), lags(gdp, 0:2), lags(transport, 1:2), lags(gas, 0:2), lags(inter, 0:2))
fit <- tsreg(transport, rhs)
# Contemporaneous Response
rec.contemp <- (coefficients(fit)[10]+ coefficients(fit)[13])*10.00
exp.contemp <- (coefficients(fit)[10])*10.00
rec.contemp
exp.contemp
(10/gas.rec)*rec.contemp - (10/gas.exp)*exp.contemp
theta.diff <- coefficients(fit)[c(10, 13)]
v.diff <- vcov(fit)[c(10, 13), c(10, 13)]
std.err.0 <- deltamethod(~((-0.11*x1+10*x2)), theta.diff, v.diff)
# Define Initial Response Vectors
x0.rec <- c(rec.contemp, 10.00, 10.00)
x0.exp <- c(exp.contemp, 10.00, 0)
rfvar <- lapply(1:5, function(h) {
rhs <- lags(dataset.transport, h:(h+1), type="bylag")
coefficients(tsreg(transport, rhs))
})
# Impulse Response in Expansion
response.exp <- lapply(rfvar, function(b) {
sum(b[4:6] * x0.exp)
})
# Impulse Response in Recession
response.rec <- lapply(rfvar, function(b) {
sum(b[4:6] * x0.rec)
})
exp <- list(exp.contemp, response.exp)
rec <- list(rec.contemp, response.rec)
transport.rec <- (cumsum(unlist(rec)))
transport.exp <- (cumsum(unlist(exp)))
transport.rec <- 10*(transport.rec/gas.rec)
transport.exp <- 10*(transport.exp/gas.exp)
d.transport <- transport.rec - transport.exp
x <- embed(cbind(auerbach, gdp, transport, gas, inter), 10)
x <- as.data.frame(x)
one.step <- embed(cbind(auerbach, gdp, transport, gas, inter), 10)[, 3] ~ embed(cbind(auerbach, gdp, transport, gas, inter), 10)[, 6:15]
two.step <- embed(cbind(auerbach, gdp, transport, gas, inter), 10)[, 3] ~ embed(cbind(auerbach, gdp, transport, gas, inter), 10)[, 11:20]
three.step <- embed(cbind(auerbach, gdp, transport, gas, inter), 10)[, 3] ~ embed(cbind(auerbach, gdp, transport, gas, inter), 10)[, 16:25]
four.step <- embed(cbind(auerbach, gdp, transport, gas, inter), 10)[, 3] ~ embed(cbind(auerbach, gdp, transport, gas, inter), 10)[, 21:30]
five.step <- embed(cbind(auerbach, gdp, transport, gas, inter), 10)[, 3] ~ embed(cbind(auerbach, gdp, transport, gas, inter), 10)[, 26:35]
six.step <- embed(cbind(auerbach, gdp, transport, gas, inter), 10)[, 3] ~ embed(cbind(auerbach, gdp, transport, gas, inter), 10)[, 31:40]
seven.step <- embed(cbind(auerbach, gdp, transport, gas, inter), 10)[, 3] ~ embed(cbind(auerbach, gdp, transport, gas, inter), 10)[, 36:45]
eight.step <- embed(cbind(auerbach, gdp, transport, gas, inter), 10)[, 3] ~ embed(cbind(auerbach, gdp, transport, gas, inter), 10)[, 41:50]
system <- list(one.step, two.step, three.step, four.step, five.step, six.step, seven.step, eight.step)
fitsur <- systemfit(system, data = x)
v <- matrix(vcov(fitsur), nrow = 88, ncol = 88)
rfvar <- lapply(1:5, function(h) {
rhs <- lags(dataset.transport, h:(h+1), type="bylag")
tsreg(transport, rhs)
})
cov.mats <- lapply(rfvar, function(z) {
NeweyWest(z)
})
replaceDiag <- function(a, mats, start=1) {
if (length(mats) == 0) {
return(a)
} else {
a[start:(start+nrow(mats[[1]])-1), start:(start+nrow(mats[[1]])-1)] <-
mats[[1]]
Recall(a, mats[-1], start+nrow(mats[[1]]))
}
}
x.newey <- replaceDiag(v, cov.mats)
# Standard Errors
# 1-Step #
theta <- coefficients(fitsur)[4:6]
v1 <- as.matrix(x.newey[c(4, 5, 6), c(4, 5, 6)])
std.err.1 <- deltamethod(~(-0.08*x1-1.03*x2+7.70*x3), theta, v1)
# 2-Step #
theta <- coefficients(fitsur)[c(4, 5, 6, 15, 16, 17)]
v2 <- as.matrix(x.newey[c(4, 5, 6, 15, 16, 17), c(4, 5, 6, 15, 16, 17)])
std.err.2 <- deltamethod(~(-0.08*x1-1.03*x2+7.70*x3-0.12*x4+2.34*x5+11.10*x6), theta, v2)
# 3-Step #
theta <- coefficients(fitsur)[c(4, 5, 6, 15, 16, 17, 26, 27, 28)]
v3 <- as.matrix(x.newey[c(4, 5, 6, 15, 16, 17, 26, 27, 28), c(4, 5, 6, 15, 16, 17, 26, 27, 28)])
std.err.3 <- deltamethod(~(-0.08*x1-1.03*x2+7.70*x3-0.12*x4+2.34*x5+11.10*x6-0.17*x7+7.87*x8+15.30*x9), theta, v3)
# 4-Step #
theta <- coefficients(fitsur)[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39)]
v4 <- as.matrix(x.newey[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39), c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39)])
std.err.4 <- deltamethod(~(-0.08*x1-1.03*x2+7.70*x3-0.12*x4+2.34*x5+11.10*x6-0.17*x7+7.87*x8+15.30*x9-0.23*x10+13.11*x11+20.51*x12), theta, v4)
# 5-Step #
theta <- coefficients(fitsur)[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50)]
v5 <- as.matrix(x.newey[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50), c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50)])
std.err.5 <- deltamethod(~(-0.08*x1-1.03*x2+7.70*x3-0.12*x4+2.34*x5+11.10*x6-0.17*x7+7.87*x8+15.30*x9-0.23*x10+13.11*x11+20.51*x12
-0.30*x13+18.96*x14+26.63*x15), theta, v5)
# 6-Step #
theta <- coefficients(fitsur)[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61)]
v6 <- as.matrix(x.newey[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61),
c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61)])
std.err.6 <- deltamethod(~(-0.08*x1-1.03*x2+7.70*x3-0.12*x4+2.34*x5+11.10*x6-0.17*x7+7.87*x8+15.30*x9-0.23*x10+13.11*x11+20.51*x12
-0.30*x13+18.96*x14+26.63*x15-0.18*x16+8.46*x17+15.99*x18), theta, v6)
# 7-Step #
theta <- coefficients(fitsur)[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61, 70, 71, 72)]
v7 <- as.matrix(x.newey[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61, 70, 71, 72),
c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61, 70, 71, 72)])
std.err.7 <- deltamethod(~(-0.08*x1-1.03*x2+7.70*x3-0.12*x4+2.34*x5+11.10*x6-0.17*x7+7.87*x8+15.30*x9-0.23*x10+13.11*x11+20.51*x12
-0.30*x13+18.96*x14+26.63*x15-0.18*x16+8.46*x17+15.99*x18-0.19*x19+9.83*x20+17.09*x21), theta, v7)
# 8-Step #
theta <- coefficients(fitsur)[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61, 70, 71, 72, 81, 82, 83)]
v8 <- as.matrix(x.newey[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61, 70, 71, 72, 81, 82, 83),
c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61, 70, 71, 72, 81, 82, 83)])
std.err.8 <- deltamethod(~(-0.08*x1-1.03*x2+7.70*x3-0.12*x4+2.34*x5+11.10*x6-0.17*x7+7.87*x8+15.30*x9-0.23*x10+13.11*x11+20.51*x12
-0.30*x13+18.96*x14+26.63*x15-0.18*x16+8.46*x17+15.99*x18-0.76*x19+9.83*x20+17.09*x21-1.08*x22+15.05*x23+22.59*x24), theta, v8)
s <- unlist(list(std.err.0, std.err.1, std.err.2, std.err.3, std.err.4, std.err.5))
d.transport.upper <- d.transport + 1.96*s
d.transport.lower <- d.transport - 1.96*s
##############################################################################################################################################################
dataset.other.services <- ts.intersect(auerbach, gdp, other.services, gas, inter)
rhs <- ts.intersect(lags(auerbach, 0:2), lags(gdp, 0:2), lags(other.services, 1:2), lags(gas, 0:2), lags(inter, 0:2))
fit <- tsreg(other.services, rhs)
# Contemporaneous Response
rec.contemp <- (coefficients(fit)[10]+ coefficients(fit)[13])*10.00
exp.contemp <- (coefficients(fit)[10])*10.00
rec.contemp
exp.contemp
(10/gas.rec)*rec.contemp - (10/gas.exp)*exp.contemp
theta.diff <- coefficients(fit)[c(10, 13)]
v.diff <- vcov(fit)[c(10, 13), c(10, 13)]
std.err.0 <- deltamethod(~((-0.45*x1+10*x2)), theta.diff, v.diff)
# Define Initial Response Vectors
x0.rec <- c(rec.contemp, 10.00, 10.00)
x0.exp <- c(exp.contemp, 10.00, 0)
rfvar <- lapply(1:5, function(h) {
rhs <- lags(dataset.other.services, h:(h+1), type="bylag")
coefficients(tsreg(other.services, rhs))
})
# Impulse Response in Expansion
response.exp <- lapply(rfvar, function(b) {
sum(b[4:6] * x0.exp)
})
# Impulse Response in Recession
response.rec <- lapply(rfvar, function(b) {
sum(b[4:6] * x0.rec)
})
exp <- list(exp.contemp, response.exp)
rec <- list(rec.contemp, response.rec)
other.services.rec <- (cumsum(unlist(rec)))
other.services.exp <- (cumsum(unlist(exp)))
other.services.rec <- 10*(other.services.rec/gas.rec)
other.services.exp <- 10*(other.services.exp/gas.exp)
d.other.services <- other.services.rec - other.services.exp
x <- embed(cbind(auerbach, gdp, other.services, gas, inter), 10)
x <- as.data.frame(x)
one.step <- embed(cbind(auerbach, gdp, other.services, gas, inter), 10)[, 3] ~ embed(cbind(auerbach, gdp, other.services, gas, inter), 10)[, 6:15]
two.step <- embed(cbind(auerbach, gdp, other.services, gas, inter), 10)[, 3] ~ embed(cbind(auerbach, gdp, other.services, gas, inter), 10)[, 11:20]
three.step <- embed(cbind(auerbach, gdp, other.services, gas, inter), 10)[, 3] ~ embed(cbind(auerbach, gdp, other.services, gas, inter), 10)[, 16:25]
four.step <- embed(cbind(auerbach, gdp, other.services, gas, inter), 10)[, 3] ~ embed(cbind(auerbach, gdp, other.services, gas, inter), 10)[, 21:30]
five.step <- embed(cbind(auerbach, gdp, other.services, gas, inter), 10)[, 3] ~ embed(cbind(auerbach, gdp, other.services, gas, inter), 10)[, 26:35]
six.step <- embed(cbind(auerbach, gdp, other.services, gas, inter), 10)[, 3] ~ embed(cbind(auerbach, gdp, other.services, gas, inter), 10)[, 31:40]
seven.step <- embed(cbind(auerbach, gdp, other.services, gas, inter), 10)[, 3] ~ embed(cbind(auerbach, gdp, other.services, gas, inter), 10)[, 36:45]
eight.step <- embed(cbind(auerbach, gdp, other.services, gas, inter), 10)[, 3] ~ embed(cbind(auerbach, gdp, other.services, gas, inter), 10)[, 41:50]
system <- list(one.step, two.step, three.step, four.step, five.step, six.step, seven.step, eight.step)
fitsur <- systemfit(system, data = x)
v <- matrix(vcov(fitsur), nrow = 88, ncol = 88)
rfvar <- lapply(1:5, function(h) {
rhs <- lags(dataset.other.services, h:(h+1), type="bylag")
tsreg(other.services, rhs)
})
cov.mats <- lapply(rfvar, function(z) {
NeweyWest(z)
})
replaceDiag <- function(a, mats, start=1) {
if (length(mats) == 0) {
return(a)
} else {
a[start:(start+nrow(mats[[1]])-1), start:(start+nrow(mats[[1]])-1)] <-
mats[[1]]
Recall(a, mats[-1], start+nrow(mats[[1]]))
}
}
x.newey <- replaceDiag(v, cov.mats)
# Standard Errors
# 1-Step #
theta <- coefficients(fitsur)[4:6]
v1 <- as.matrix(x.newey[c(4, 5, 6), c(4, 5, 6)])
std.err.1 <- deltamethod(~(-0.31*x1-1.03*x2+7.70*x3), theta, v1)
# 2-Step #
theta <- coefficients(fitsur)[c(4, 5, 6, 15, 16, 17)]
v2 <- as.matrix(x.newey[c(4, 5, 6, 15, 16, 17), c(4, 5, 6, 15, 16, 17)])
std.err.2 <- deltamethod(~(-0.31*x1-1.03*x2+7.70*x3-0.57*x4+2.34*x5+11.10*x6), theta, v2)
# 3-Step #
theta <- coefficients(fitsur)[c(4, 5, 6, 15, 16, 17, 26, 27, 28)]
v3 <- as.matrix(x.newey[c(4, 5, 6, 15, 16, 17, 26, 27, 28), c(4, 5, 6, 15, 16, 17, 26, 27, 28)])
std.err.3 <- deltamethod(~(-0.31*x1-1.03*x2+7.70*x3-0.57*x4+2.34*x5+11.10*x6-0.94*x7+7.87*x8+15.30*x9), theta, v3)
# 4-Step #
theta <- coefficients(fitsur)[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39)]
v4 <- as.matrix(x.newey[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39), c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39)])
std.err.4 <- deltamethod(~(-0.31*x1-1.03*x2+7.70*x3-0.57*x4+2.34*x5+11.10*x6-0.94*x7+7.87*x8+15.30*x9-1.35*x10+13.11*x11+20.51*x12), theta, v4)
# 5-Step #
theta <- coefficients(fitsur)[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50)]
v5 <- as.matrix(x.newey[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50), c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50)])
std.err.5 <- deltamethod(~(-0.31*x1-1.03*x2+7.70*x3-0.57*x4+2.34*x5+11.10*x6-0.94*x7+7.87*x8+15.30*x9-1.35*x10+13.11*x11+20.51*x12
-1.81*x13+18.96*x14+26.63*x15), theta, v5)
# 6-Step #
theta <- coefficients(fitsur)[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61)]
v6 <- as.matrix(x.newey[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61),
c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61)])
std.err.6 <- deltamethod(~(-0.31*x1-1.03*x2+7.70*x3-0.57*x4+2.34*x5+11.10*x6-0.94*x7+7.87*x8+15.30*x9-1.35*x10+13.11*x11+20.51*x12
-1.81*x13+18.96*x14+26.63*x15-0.99*x16+8.46*x17+15.99*x18), theta, v6)
# 7-Step #
theta <- coefficients(fitsur)[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61, 70, 71, 72)]
v7 <- as.matrix(x.newey[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61, 70, 71, 72),
c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61, 70, 71, 72)])
std.err.7 <- deltamethod(~(-0.31*x1-1.03*x2+7.70*x3-0.57*x4+2.34*x5+11.10*x6-0.94*x7+7.87*x8+15.30*x9-1.35*x10+13.11*x11+20.51*x12
-1.81*x13+18.96*x14+26.63*x15-0.99*x16+8.46*x17+15.99*x18-1.09*x19+9.83*x20+17.09*x21), theta, v7)
# 8-Step #
theta <- coefficients(fitsur)[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61, 70, 71, 72, 81, 82, 83)]
v8 <- as.matrix(x.newey[c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61, 70, 71, 72, 81, 82, 83),
c(4, 5, 6, 15, 16, 17, 26, 27, 28, 37, 38, 39, 48, 49, 50, 59, 60, 61, 70, 71, 72, 81, 82, 83)])
std.err.8 <- deltamethod(~(-0.31*x1-1.03*x2+7.70*x3-0.57*x4+2.34*x5+11.10*x6-0.94*x7+7.87*x8+15.30*x9-1.35*x10+13.11*x11+20.51*x12
-1.81*x13+18.96*x14+26.63*x15-0.99*x16+8.46*x17+15.99*x18-1.09*x19+9.83*x20+17.09*x21-1.50*x22+15.05*x23+22.59*x24), theta, v8)
s <- unlist(list(std.err.0, std.err.1, std.err.2, std.err.3, std.err.4, std.err.5))
d.other.services.upper <- d.other.services + 1.96*s
d.other.services.lower <- d.other.services - 1.96*s
par(mfrow=c(2,3))
plot(motor.rec, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-20, 10), main = "Motor Vehicles - Response to Gasoline Expenditure Shock"); abline(h=0)
points(motor.exp, type = "l", col = "black", lty=2)
plot(d.motor, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-20, 10), main = "Motor Vehicles - Difference Across Regimes"); abline(h=0)
points(d.motor.upper , col = "black", type="l", lty=2)
points(d.motor.lower, col = "black", type="l", lty=2)
plot(furnishing.rec, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-10, 5), main = "Furnishing - Response to Gasoline Expenditure Shock"); abline(h=0)
points(furnishing.exp, type = "l", col = "black", lty=2)
plot(d.furnishing, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-10, 5), main = "Furnishing - Difference Across Regimes"); abline(h=0)
points(d.furnishing.upper , col = "black", type="l", lty=2)
points(d.furnishing.lower, col = "black", type="l", lty=2)
plot(otherdurable.rec, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-10, 5), main = "Other Durables - Response to Gasoline Expenditure Shock"); abline(h=0)
points(otherdurable.exp, type = "l", col = "black", lty=2)
plot(d.otherdurable, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-10, 5), main = "Other Durables - Difference Across Regimes"); abline(h=0)
points(d.otherdurable.upper , col = "black", type="l", lty=2)
points(d.otherdurable.lower, col = "black", type="l", lty=2)
plot(food.rec, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-5, 2), main = "Food - Response to Gasoline Expenditure Shock"); abline(h=0)
points(food.exp, type = "l", col = "black", lty=2)
plot(d.food, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-5, 2), main = "Food - Difference Across Regimes"); abline(h=0)
points(d.food.upper , col = "black", type="l", lty=2)
points(d.food.lower, col = "black", type="l", lty=2)
plot(clothing.rec, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-6, 2), main = "Clothing - Response to Gasoline Expenditure Shock"); abline(h=0)
points(clothing.exp, type = "l", col = "black", lty=2)
plot(d.clothing, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-6, 2), main = "Clothing"); abline(h=0)
points(d.clothing.upper , col = "black", type="l", lty=2)
points(d.clothing.lower, col = "black", type="l", lty=2)
plot(othernondurable.rec, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-10, 2), main = "Other Nondurables - Response to Gasoline Expenditure Shock"); abline(h=0)
points(othernondurable.exp, type = "l", col = "black", lty=2)
plot(d.othernondurable, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-10, 2), main = "Other Nondurables - Difference Across Regimes"); abline(h=0)
points(d.othernondurable.upper , col = "black", type="l", lty=2)
points(d.othernondurable.lower, col = "black", type="l", lty=2)
plot(housing.rec, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-5, 5), main = "Housing & Utilities - Response to Gasoline Expenditure Shock"); abline(h=0)
points(housing.exp, type = "l", col = "black", lty=2)
plot(d.housing, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-5, 5), main = "Housing & Utilities - Difference Across Regimes"); abline(h=0)
points(d.housing.upper , col = "black", type="l", lty=2)
points(d.housing.lower, col = "black", type="l", lty=2)
plot(transport.rec, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-5, 5), main = "Transportation - Response to Gasoline Expenditure Shock"); abline(h=0)
points(transport.exp, type = "l", col = "black", lty=2)
plot(d.transport, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-5, 5), main = "Transportation - Difference Across Regimes"); abline(h=0)
points(d.transport.upper , col = "black", type="l", lty=2)
points(d.transport.lower, col = "black", type="l", lty=2)
plot(other.services.rec, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-5, 5), main = "Other Services - Response to Gasoline Expenditure Shock"); abline(h=0)
points(other.services.exp, type = "l", col = "black", lty=2)
plot(d.other.services, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-5, 5), main = "Other Services - Difference Across Regimes"); abline(h=0)
points(d.other.services.upper , col = "black", type="l", lty=2)
points(d.other.services.lower, col = "black", type="l", lty=2)
plot(motor.rec, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-20, 10), main = "Motor Vehicles"); abline(h=0)
points(motor.exp, type = "l", col = "black", lty=2)
plot(furnishing.rec, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-10, 5), main = "Furnishing"); abline(h=0)
points(furnishing.exp, type = "l", col = "black", lty=2)
plot(otherdurable.rec, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-10, 5), main = "Other Durables"); abline(h=0)
points(otherdurable.exp, type = "l", col = "black", lty=2)
plot(d.motor, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-20, 10), main = "Motor Vehicles"); abline(h=0)
points(d.motor.upper , col = "black", type="l", lty=2)
points(d.motor.lower, col = "black", type="l", lty=2)
plot(d.furnishing, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-10, 5), main = "Furnishing"); abline(h=0)
points(d.furnishing.upper , col = "black", type="l", lty=2)
points(d.furnishing.lower, col = "black", type="l", lty=2)
plot(d.otherdurable, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-10, 5), main = "Other Durables"); abline(h=0)
points(d.otherdurable.upper , col = "black", type="l", lty=2)
points(d.otherdurable.lower, col = "black", type="l", lty=2)
plot(food.rec, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-5, 2), main = "Food"); abline(h=0)
points(food.exp, type = "l", col = "black", lty=2)
plot(clothing.rec, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-6, 2), main = "Clothing"); abline(h=0)
points(clothing.exp, type = "l", col = "black", lty=2)
plot(othernondurable.rec, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-10, 2), main = "Other Nondurables"); abline(h=0)
points(othernondurable.exp, type = "l", col = "black", lty=2)
plot(d.food, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-5, 2), main = "Food"); abline(h=0)
points(d.food.upper , col = "black", type="l", lty=2)
points(d.food.lower, col = "black", type="l", lty=2)
plot(d.clothing, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-6, 2), main = "Clothing"); abline(h=0)
points(d.clothing.upper , col = "black", type="l", lty=2)
points(d.clothing.lower, col = "black", type="l", lty=2)
plot(d.othernondurable, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-10, 2), main = "Other Nondurables"); abline(h=0)
points(d.othernondurable.upper , col = "black", type="l", lty=2)
points(d.othernondurable.lower, col = "black", type="l", lty=2)
plot(housing.rec, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-5, 5), main = "Housing & Utilities"); abline(h=0)
points(housing.exp, type = "l", col = "black", lty=2)
lot(transport.rec, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-5, 5), main = "Transportation"); abline(h=0)
points(transport.exp, type = "l", col = "black", lty=2)
plot(transport.rec, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-5, 5), main = "Transportation"); abline(h=0)
points(transport.exp, type = "l", col = "black", lty=2)
plot(other.services.rec, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-5, 5), main = "Other Services"); abline(h=0)
points(other.services.exp, type = "l", col = "black", lty=2)
plot(d.housing, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-5, 5), main = "Housing & Utilities"); abline(h=0)
points(d.housing.upper , col = "black", type="l", lty=2)
points(d.housing.lower, col = "black", type="l", lty=2)
plot(d.transport, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-5, 5), main = "Transportation"); abline(h=0)
points(d.transport.upper , col = "black", type="l", lty=2)
points(d.transport.lower, col = "black", type="l", lty=2)
plot(d.other.services, type = "l", col = "black", xlab = "Quarters", ylab = "% Change", ylim= c(-5, 5), main = "Other Services"); abline(h=0)
points(d.other.services.upper , col = "black", type="l", lty=2)
points(d.other.services.lower, col = "black", type="l", lty=2)
library(vars)
library(tstools)
gas.shock <- 10
par(mfrow=c(1,1))
irf.linear <- function(obj) {
macro <- obj[[1]]
varname <- obj[[2]]
rhs <- ts.intersect(lags(auerbach, 0:2), lags(gdp, 0:2), lags(macro, 1:2), lags(gas, 0:2), lags(inter, 0:2))
fit <- tsreg(macro, rhs)
macro.nonlinear <- (coefficients(fit)[1]+coefficients(fit)[2]*auerbach+coefficients(fit)[3]*lags(auerbach,1)
+coefficients(fit)[4]*lags(auerbach,2)+coefficients(fit)[5]*gdp+coefficients(fit)[6]*lags(gdp,1)
+coefficients(fit)[7]*lags(gdp,2)+coefficients(fit)[8]*lags(pce,1)+coefficients(fit)[9]*lags(pce,2)
+coefficients(fit)[10]*gas.shock+coefficients(fit)[11]*lags(gas,1)+coefficients(fit)[12]*lags(gas,2)
+coefficients(fit)[13]*(auerbach*gas.shock)+coefficients(fit)[14]*lags(inter,1)+coefficients(fit)[15]*lags(inter,2))
macro.linear <- (coefficients(fit)[1]+coefficients(fit)[5]*gdp+coefficients(fit)[6]*lags(gdp,1)+coefficients(fit)[7]*lags(gdp,2)
+coefficients(fit)[8]*lags(pce,1)+coefficients(fit)[9]*lags(pce,2)+coefficients(fit)[10]*gas.shock
+coefficients(fit)[11]*lags(gas,1)+coefficients(fit)[12]*lags(gas,2))
plot(macro.nonlinear, type = "l", col = "blue", xlab = "Year", ylim = c(-2, 2), ylab = "% Change", main = varname); abline(h=0)
points(macro.linear , col = "red", type="l", lty=2)
legend("topright", c("Nonlinear","Linear"), fill=c("blue","red"))
d <- macro.nonlinear - macro.linear
plot(d, type = "n", col = "black", xlab = "Year", ylim = c(-2, 2), ylab = "% Change", main = varname)
nberShade()
abline(h=0)
lines(d)
return(macro.linear)
}
varinfo <- list(
list(pce, "PCE"),
list(nondurable, "Nondurables"),
list(services, "Services"))
irfs <- lapply(varinfo, irf.linear)
irf.linear <- function(obj) {
macro <- obj[[1]]
varname <- obj[[2]]
rhs <- ts.intersect(lags(auerbach, 0:2), lags(gdp, 0:2), lags(macro, 1:2), lags(gas, 0:2), lags(inter, 0:2))
fit <- tsreg(macro, rhs)
macro.nonlinear <- (coefficients(fit)[1]+coefficients(fit)[2]*auerbach+coefficients(fit)[3]*lags(auerbach,1)
+coefficients(fit)[4]*lags(auerbach,2)+coefficients(fit)[5]*gdp+coefficients(fit)[6]*lags(gdp,1)
+coefficients(fit)[7]*lags(gdp,2)+coefficients(fit)[8]*lags(pce,1)+coefficients(fit)[9]*lags(pce,2)
+coefficients(fit)[10]*gas.shock+coefficients(fit)[11]*lags(gas,1)+coefficients(fit)[12]*lags(gas,2)
+coefficients(fit)[13]*(auerbach*gas.shock)+coefficients(fit)[14]*lags(inter,1)+coefficients(fit)[15]*lags(inter,2))
macro.linear <- (coefficients(fit)[1]+coefficients(fit)[5]*gdp+coefficients(fit)[6]*lags(gdp,1)+coefficients(fit)[7]*lags(gdp,2)
+coefficients(fit)[8]*lags(pce,1)+coefficients(fit)[9]*lags(pce,2)+coefficients(fit)[10]*gas.shock
+coefficients(fit)[11]*lags(gas,1)+coefficients(fit)[12]*lags(gas,2))
plot(macro.nonlinear, type = "l", col = "blue", xlab = "Year", ylim = c(-10, 10), ylab = "% Change", main = varname); abline(h=0)
points(macro.linear , col = "red", type="l", lty=2)
legend("topright", c("Nonlinear","Linear"), fill=c("blue","red"))
d <- macro.nonlinear - macro.linear
plot(d, type = "l", col = "black", xlab = "Year", ylim = c(-10, 10), ylab = "% Change", main = varname)
nberShade()
abline(h=0)
lines(d)
}
varinfo <- list(
list(durable, "Durables"))
irfs <- lapply(varinfo, irf.linear)
par(mfrow=c(1,1))
irf.linear <- function(obj) {
macro <- obj[[1]]
varname <- obj[[2]]
rhs <- ts.intersect(lags(auerbach, 0:2), lags(gdp, 0:2), lags(macro, 1:2), lags(gas, 0:2), lags(inter, 0:2))
fit <- tsreg(macro, rhs)
macro.nonlinear <- (coefficients(fit)[1]+coefficients(fit)[2]*auerbach+coefficients(fit)[3]*lags(auerbach,1)
+coefficients(fit)[4]*lags(auerbach,2)+coefficients(fit)[5]*gdp+coefficients(fit)[6]*lags(gdp,1)
+coefficients(fit)[7]*lags(gdp,2)+coefficients(fit)[8]*lags(pce,1)+coefficients(fit)[9]*lags(pce,2)
+coefficients(fit)[10]*gas.shock+coefficients(fit)[11]*lags(gas,1)+coefficients(fit)[12]*lags(gas,2)
+coefficients(fit)[13]*(auerbach*gas.shock)+coefficients(fit)[14]*lags(inter,1)+coefficients(fit)[15]*lags(inter,2))
macro.linear <- (coefficients(fit)[1]+coefficients(fit)[5]*gdp+coefficients(fit)[6]*lags(gdp,1)+coefficients(fit)[7]*lags(gdp,2)
+coefficients(fit)[8]*lags(pce,1)+coefficients(fit)[9]*lags(pce,2)+coefficients(fit)[10]*gas.shock
+coefficients(fit)[11]*lags(gas,1)+coefficients(fit)[12]*lags(gas,2))
plot(macro.nonlinear, type = "l", col = "blue", xlab = "Year", ylim = c(-2, 2), ylab = "% Change", main = varname); abline(h=0)
points(macro.linear , col = "red", type="l", lty=2)
nberShade()
legend("topright", c("Nonlinear","Linear"), fill=c("blue","red"))
d <- macro.nonlinear - macro.linear
plot(d, type = "n", col = "black", xlab = "Year", ylim = c(-2, 2), ylab = "% Change", main = varname)
nberShade()
abline(h=0)
lines(d)
return(macro.linear)
}
varinfo <- list(
list(pce, "PCE"),
list(nondurable, "Nondurables"),
list(services, "Services"))
irfs <- lapply(varinfo, irf.linear)
par(mfrow=c(1,1))
irf.linear <- function(obj) {
macro <- obj[[1]]
varname <- obj[[2]]
rhs <- ts.intersect(lags(auerbach, 0:2), lags(gdp, 0:2), lags(macro, 1:2), lags(gas, 0:2), lags(inter, 0:2))
fit <- tsreg(macro, rhs)
macro.nonlinear <- (coefficients(fit)[1]+coefficients(fit)[2]*auerbach+coefficients(fit)[3]*lags(auerbach,1)
+coefficients(fit)[4]*lags(auerbach,2)+coefficients(fit)[5]*gdp+coefficients(fit)[6]*lags(gdp,1)
+coefficients(fit)[7]*lags(gdp,2)+coefficients(fit)[8]*lags(pce,1)+coefficients(fit)[9]*lags(pce,2)
+coefficients(fit)[10]*gas.shock+coefficients(fit)[11]*lags(gas,1)+coefficients(fit)[12]*lags(gas,2)
+coefficients(fit)[13]*(auerbach*gas.shock)+coefficients(fit)[14]*lags(inter,1)+coefficients(fit)[15]*lags(inter,2))
macro.linear <- (coefficients(fit)[1]+coefficients(fit)[5]*gdp+coefficients(fit)[6]*lags(gdp,1)+coefficients(fit)[7]*lags(gdp,2)
+coefficients(fit)[8]*lags(pce,1)+coefficients(fit)[9]*lags(pce,2)+coefficients(fit)[10]*gas.shock
+coefficients(fit)[11]*lags(gas,1)+coefficients(fit)[12]*lags(gas,2))
plot(macro.nonlinear, type = "l", col = "blue", xlab = "Year", ylim = c(-2, 2), ylab = "% Change", main = varname); abline(h=0)
points(macro.linear , col = "red", type="l", lty=2)
legend("topright", c("Nonlinear Forecasts","Linear Forecasts"), fill=c("blue","red"))
d <- macro.nonlinear - macro.linear
plot(d, type = "n", col = "black", xlab = "Year", ylim = c(-2, 2), ylab = "% Change", main = varname)
nberShade()
abline(h=0)
lines(d)
return(macro.linear)
}
varinfo <- list(
list(pce, "PCE"),
list(nondurable, "Nondurables"),
list(services, "Services"))
irfs <- lapply(varinfo, irf.linear)
irf.linear <- function(obj) {
macro <- obj[[1]]
varname <- obj[[2]]
rhs <- ts.intersect(lags(auerbach, 0:2), lags(gdp, 0:2), lags(macro, 1:2), lags(gas, 0:2), lags(inter, 0:2))
fit <- tsreg(macro, rhs)
macro.nonlinear <- (coefficients(fit)[1]+coefficients(fit)[2]*auerbach+coefficients(fit)[3]*lags(auerbach,1)
+coefficients(fit)[4]*lags(auerbach,2)+coefficients(fit)[5]*gdp+coefficients(fit)[6]*lags(gdp,1)
+coefficients(fit)[7]*lags(gdp,2)+coefficients(fit)[8]*lags(pce,1)+coefficients(fit)[9]*lags(pce,2)
+coefficients(fit)[10]*gas.shock+coefficients(fit)[11]*lags(gas,1)+coefficients(fit)[12]*lags(gas,2)
+coefficients(fit)[13]*(auerbach*gas.shock)+coefficients(fit)[14]*lags(inter,1)+coefficients(fit)[15]*lags(inter,2))
macro.linear <- (coefficients(fit)[1]+coefficients(fit)[5]*gdp+coefficients(fit)[6]*lags(gdp,1)+coefficients(fit)[7]*lags(gdp,2)
+coefficients(fit)[8]*lags(pce,1)+coefficients(fit)[9]*lags(pce,2)+coefficients(fit)[10]*gas.shock
+coefficients(fit)[11]*lags(gas,1)+coefficients(fit)[12]*lags(gas,2))
plot(macro.nonlinear, type = "l", col = "blue", xlab = "Year", ylim = c(-10, 10), ylab = "% Change", main = varname); abline(h=0)
points(macro.linear , col = "red", type="l", lty=2)
legend("topright", c("Nonlinear Forecasts","Linear Forecasts"), fill=c("blue","red"))
d <- macro.nonlinear - macro.linear
plot(d, type = "l", col = "black", xlab = "Year", ylim = c(-10, 10), ylab = "% Change", main = varname)
nberShade()
abline(h=0)
lines(d)
}
varinfo <- list(
list(durable, "Durables"))
irfs <- lapply(varinfo, irf.linear)
